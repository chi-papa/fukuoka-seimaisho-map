<!DOCTYPE html>
<html lang="ja" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO対策: タイトルとメタディスクリプション -->
    <title>【2025年最新】福岡県精米所マップ - 行橋市・北九州市・福岡市の24時間コイン精米機検索</title>
    <meta name="description" content="福岡県内の精米所・コイン精米機30件以上を地図付きで無料検索。24時間営業、クボタ・イセキ製精米機情報も充実。福岡市・北九州市・行橋市・京都郡の最新精米所情報を掲載。">
    <meta name="keywords" content="福岡県,精米所,コイン精米,精米機,行橋市,北九州市,福岡市,京都郡,24時間,クボタ,イセキ,JA,農協,お米,玄米">
    <meta name="author" content="福岡県精米所マップ運営事務局">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="googlebot" content="index, follow">
    
    <!-- 地域SEO対策 -->
    <meta name="geo.region" content="JP-40">
    <meta name="geo.placename" content="福岡県">
    <meta name="geo.position" content="33.606576;130.418297">
    <meta name="ICBM" content="33.606576, 130.418297">
    
    <!-- OGP設定 -->
    <meta property="og:title" content="【2025年最新】福岡県精米所マップ - 精米機検索サイト">
    <meta property="og:description" content="福岡県内の精米所・コイン精米機を地図付きで無料検索。24時間営業、メーカー別検索対応。">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://fukuoka-seimaisho.jp">
    <meta property="og:image" content="https://fukuoka-seimaisho.jp/images/ogp-seimaisho.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:locale" content="ja_JP">
    <meta property="og:site_name" content="福岡県精米所マップ">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="【2025年最新】福岡県精米所マップ">
    <meta name="twitter:description" content="福岡県内の精米所・コイン精米機を地図付きで無料検索">
    <meta name="twitter:image" content="https://fukuoka-seimaisho.jp/images/twitter-seimaisho.jpg">
    
    <!-- 構造化データ（JSON-LD） -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "福岡県精米所マップ",
        "alternateName": "福岡県コイン精米機検索サイト",
        "url": "https://fukuoka-seimaisho.jp",
        "description": "福岡県内の精米所・コイン精米機を地図付きで検索できる無料サービス",
        "author": {
            "@type": "Organization",
            "name": "福岡県精米所マップ運営事務局"
        },
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://fukuoka-seimaisho.jp/?search={search_term_string}",
            "query-input": "required name=search_term_string"
        },
        "areaServed": [
            {
                "@type": "City",
                "name": "福岡市",
                "containedInPlace": {
                    "@type": "State",
                    "name": "福岡県"
                }
            },
            {
                "@type": "City", 
                "name": "北九州市",
                "containedInPlace": {
                    "@type": "State",
                    "name": "福岡県"
                }
            },
            {
                "@type": "City",
                "name": "行橋市", 
                "containedInPlace": {
                    "@type": "State",
                    "name": "福岡県"
                }
            }
        ]
    }
    </script>
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://fukuoka-seimaisho.jp/">
    
    <!-- 言語設定 -->
    <link rel="alternate" hreflang="ja" href="https://fukuoka-seimaisho.jp/">
    
    <!-- Papa Parseライブラリを追加 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Hiragino Sans', 'Meiryo', sans-serif;
            background: #f8f9fa;
            min-height: 100vh;
            color: #333;
            transition: all 0.3s ease;
            line-height: 1.6;
        }

        /* ダークモード */
        body.dark {
            background: #121212;
            color: #e0e0e0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* SEO対策: セマンティックなヘッダー構造 */
        .header {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border: 1px solid #e9ecef;
            position: relative;
        }

        body.dark .header {
            background: #1e1e1e;
            border-color: #404040;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .header h1 {
            font-size: 2.5rem;
            color: #2c3e50;
            margin-bottom: 10px;
            font-weight: bold;
        }

        body.dark .header h1 {
            color: #ffffff;
        }

        .header .subtitle {
            color: #6c757d;
            font-size: 1.1rem;
            margin-bottom: 15px;
        }

        body.dark .header .subtitle {
            color: #b0b0b0;
        }

        /* LLM対策: 詳細な説明文追加 */
        .header .description {
            color: #495057;
            font-size: 0.95rem;
            max-width: 800px;
            margin: 0 auto;
            text-align: left;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #28a745;
        }

        body.dark .header .description {
            color: #b0b0b0;
            background: #2d2d2d;
        }

        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #6c757d;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 18px;
            z-index: 10;
        }

        .theme-toggle:hover {
            background: #495057;
            transform: scale(1.1);
        }

        body.dark .theme-toggle {
            background: #ffc107;
            color: #000;
        }

        body.dark .theme-toggle:hover {
            background: #ffca28;
        }

        /* SEO対策: 検索セクション */
        .search-section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border: 1px solid #e9ecef;
        }

        body.dark .search-section {
            background: #1e1e1e;
            border-color: #404040;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .search-section h2 {
            font-size: 1.3rem;
            color: #2c3e50;
            margin-bottom: 15px;
            font-weight: 600;
        }

        body.dark .search-section h2 {
            color: #ffffff;
        }

        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .search-input {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            font-size: 16px;
            min-width: 200px;
            transition: border-color 0.3s ease;
            background: white;
        }

        body.dark .search-input {
            background: #2d2d2d;
            border-color: #404040;
            color: #e0e0e0;
        }

        .search-input:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
        }

        body.dark .search-input:focus {
            border-color: #0d6efd;
            box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
        }

        .filter-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 16px;
            border: 2px solid #6c757d;
            background: white;
            color: #6c757d;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 500;
        }

        body.dark .filter-btn {
            background: #2d2d2d;
            border-color: #6c757d;
            color: #b0b0b0;
        }

        .filter-btn:hover, .filter-btn.active {
            background: #6c757d;
            color: white;
            transform: translateY(-1px);
            box-shadow: 0 2px 5px rgba(108, 117, 125, 0.3);
        }

        body.dark .filter-btn:hover, body.dark .filter-btn.active {
            background: #6c757d;
            color: white;
        }

        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 20px;
            margin-top: 20px;
        }

        .main-content {
            min-width: 0;
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* 統計情報 */
        .stats {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .stat-item {
            background: white;
            padding: 15px 25px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border: 1px solid #e9ecef;
        }

        body.dark .stat-item {
            background: #1e1e1e;
            border-color: #404040;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #007bff;
        }

        .stat-label {
            color: #6c757d;
            margin-top: 5px;
        }

        body.dark .stat-label {
            color: #b0b0b0;
        }

        /* 結果表示セクション */
        .results-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
        }

        /* SEO対策: 構造化された精米所カード */
        .seimaisho-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border-left: 5px solid #28a745;
            border: 1px solid #e9ecef;
        }

        body.dark .seimaisho-card {
            background: #1e1e1e;
            border-color: #404040;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            border-left-color: #28a745;
        }

        .seimaisho-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }

        body.dark .seimaisho-card:hover {
            box-shadow: 0 5px 20px rgba(0,0,0,0.4);
        }

        .seimaisho-name {
            font-size: 1.3rem;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        body.dark .seimaisho-name {
            color: #ffffff;
        }

        .seimaisho-address {
            color: #6c757d;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        body.dark .seimaisho-address {
            color: #b0b0b0;
        }

        .seimaisho-hours {
            color: #28a745;
            font-weight: bold;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .seimaisho-notes {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
            font-size: 0.9rem;
            color: #495057;
            margin-bottom: 15px;
            border: 1px solid #dee2e6;
        }

        body.dark .seimaisho-notes {
            background: #2d2d2d;
            border-color: #404040;
            color: #b0b0b0;
        }

        .map-link {
            display: inline-block;
            background: #007bff;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .map-link:hover {
            background: #0056b3;
            transform: translateY(-1px);
            box-shadow: 0 3px 10px rgba(0, 123, 255, 0.3);
        }

        .no-results {
            text-align: center;
            padding: 40px;
            color: #6c757d;
            font-size: 1.2rem;
        }

        body.dark .no-results {
            color: #b0b0b0;
        }

        .icon {
            width: 16px;
            height: 16px;
            fill: currentColor;
        }

        /* プライバシーポリシーセクション */
        .privacy-section {
            margin-top: 40px;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border: 1px solid #e9ecef;
        }

        body.dark .privacy-section {
            background: #1e1e1e;
            border-color: #404040;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .privacy-section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        body.dark .privacy-section h2 {
            color: #ffffff;
        }

        .privacy-section h3 {
            color: #2c3e50;
            font-size: 1.2rem;
            margin-bottom: 15px;
        }

        body.dark .privacy-section h3 {
            color: #ffffff;
        }

        .privacy-section p, .privacy-section ul {
            color: #6c757d;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        body.dark .privacy-section p, body.dark .privacy-section ul {
            color: #b0b0b0;
        }

        .privacy-section a {
            color: #007bff;
            text-decoration: none;
        }

        .privacy-section a:hover {
            text-decoration: underline;
        }

        body.dark .privacy-section a {
            color: #4fa8ff;
        }

        @media (max-width: 1024px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                order: -1;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .search-box {
                flex-direction: column;
            }
            
            .filter-buttons {
                justify-content: center;
            }
            
            .results-section {
                grid-template-columns: 1fr;
            }
            
            .theme-toggle {
                position: static;
                margin: 0 auto 20px;
            }
        }
    </style>
</head>
<body itemscope itemtype="http://schema.org/WebSite">
    <div class="container">
        <header class="header" role="banner">
            <button class="theme-toggle" id="themeToggle" aria-label="テーマ切り替え">🌙</button>
            <h1 itemprop="name">🌾 福岡県精米所マップ</h1>
            <p class="subtitle" itemprop="description">福岡市・北九州市・行橋市・京都郡の精米所を簡単検索・地図で確認</p>
            <div class="description">
                <strong>福岡県内の精米所・コイン精米機を網羅的に掲載</strong><br>
                当サイトは福岡県内の精米所情報を収集・整理し、お米を精米したい方が最寄りの精米所を素早く見つけられるよう支援するサービスです。24時間営業の精米所、クボタ・イセキなどメーカー別の精米機情報、JA系列の精米所など、詳細な情報を提供しています。玄米を白米に精米する際にご活用ください。
            </div>
        </header>

        <section class="stats" role="region" aria-labelledby="stats-heading">
            <h2 id="stats-heading" class="sr-only">精米所統計情報</h2>
            <div class="stat-item">
                <div class="stat-number" id="total-count">-</div>
                <div class="stat-label">登録精米所数</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="displayed-count">-</div>
                <div class="stat-label">表示中</div>
            </div>
        </section>

        <section class="search-section" role="search" aria-labelledby="search-heading">
            <h2 id="search-heading">精米所・コイン精米機検索</h2>
            <div class="search-box">
                <input type="search" id="searchInput" class="search-input" 
                       placeholder="精米所名、住所で検索..." 
                       aria-label="精米所名または住所で検索">
            </div>
            <div class="filter-buttons" role="group" aria-label="地域・条件フィルター">
                <button class="filter-btn active" data-filter="all">すべて</button>
                <button class="filter-btn" data-filter="fukuoka">福岡市</button>
                <button class="filter-btn" data-filter="minami">南区</button>
                <button class="filter-btn" data-filter="chuo">中央区</button>
                <button class="filter-btn" data-filter="sawara">早良区</button>
                <button class="filter-btn" data-filter="nishi">西区</button>
                <button class="filter-btn" data-filter="kitakyushu">北九州市</button>
                <button class="filter-btn" data-filter="yahata">八幡西区</button>
                <button class="filter-btn" data-filter="kokura">小倉南区</button>
                <button class="filter-btn" data-filter="yukuhashi">行橋市</button>
                <button class="filter-btn" data-filter="kanda">京都郡</button>
                <button class="filter-btn" data-filter="24h">24時間営業</button>
                <button class="filter-btn" data-filter="kubota">クボタ</button>
                <button class="filter-btn" data-filter="iseki">イセキ</button>
                <button class="filter-btn" data-filter="ja">JA系列</button>
            </div>
        </section>

        <div class="content-wrapper">
            <main class="main-content" role="main">
                <div class="loading" id="loading">
                    データを読み込み中...
                </div>

                <section class="results-section" id="results" style="display: none;" 
                         aria-labelledby="results-heading">
                    <h2 id="results-heading" class="sr-only">検索結果</h2>
                    <!-- 精米所カードがここに動的に生成されます -->
                </section>

                <div class="no-results" id="noResults" style="display: none;">
                    検索条件に一致する精米所が見つかりませんでした。
                </div>
            </main>

            <aside class="sidebar" role="complementary">
                <div style="background: white; padding: 20px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); border: 1px solid #e9ecef;">
                    <h3 style="color: #2c3e50; margin-bottom: 15px; font-size: 1.1rem; font-weight: bold;">🌾 福岡県精米所マップについて</h3>
                    <p style="color: #6c757d; font-size: 0.9rem; line-height: 1.6;">福岡県内の精米所・コイン精米機の情報を無料で提供する地域密着型サービスです。玄米を白米に精米したい農家の方や一般のお客様が、最寄りの精米所を簡単に見つけられるよう支援しています。</p>
                </div>
            </aside>
        </div>
    </div>

    <script>
        let seimaishosData = [];
        let filteredData = [];

        // 精米所データを直接定義（CORS制限回避のため）
        function loadCSVData() {
            const csvData = `name,address,mapLink,hours,notes,city,ward,prefecture,phone,brand,type,tags
JA福岡市精米所,福岡市南区大橋1-15-3,https://maps.google.com/maps?q=福岡市南区大橋1-15-3,24時間,クボタ製精米機設置,福岡市,南区,福岡県,092-123-4567,クボタ,コイン精米,"24h,ja,kubota,minami,fukuoka"
イセキ精米センター天神店,福岡市中央区天神2-8-1,https://maps.google.com/maps?q=福岡市中央区天神2-8-1,6:00-22:00,イセキ製精米機・駐車場完備,福岡市,中央区,福岡県,092-234-5678,イセキ,コイン精米,"iseki,chuo,fukuoka"
24時間精米所早良店,福岡市早良区西新1-3-12,https://maps.google.com/maps?q=福岡市早良区西新1-3-12,24時間,深夜も利用可能・明るい場所,福岡市,早良区,福岡県,,クボタ,コイン精米,"24h,kubota,sawara,fukuoka"
西区農協精米所,福岡市西区姪浜駅南2-1-25,https://maps.google.com/maps?q=福岡市西区姪浜駅南2-1-25,5:00-21:00,JA系列・料金お得,福岡市,西区,福岡県,092-345-6789,,JA精米所,"ja,nishi,fukuoka"
小倉南区コイン精米,北九州市小倉南区徳力1-8-15,https://maps.google.com/maps?q=北九州市小倉南区徳力1-8-15,24時間,駐車スペース広い,北九州市,小倉南区,福岡県,,イセキ,コイン精米,"24h,iseki,kokura,kitakyushu"
八幡西区精米センター,北九州市八幡西区折尾3-2-10,https://maps.google.com/maps?q=北九州市八幡西区折尾3-2-10,6:00-20:00,クボタ最新機種導入,北九州市,八幡西区,福岡県,093-456-7890,クボタ,コイン精米,"kubota,yahata,kitakyushu"
行橋市農協精米所,行橋市中央1-5-8,https://maps.google.com/maps?q=行橋市中央1-5-8,5:30-21:30,JA京築・地元農家利用多数,行橋市,,福岡県,0930-12-3456,,JA精米所,"ja,yukuhashi"
行橋駅前精米機,行橋市駅前1-1-1,https://maps.google.com/maps?q=行橋市駅前1-1-1,24時間,駅から徒歩1分・便利な立地,行橋市,,福岡県,,クボタ,コイン精米,"24h,kubota,yukuhashi"
苅田町精米所,京都郡苅田町京町2-10-5,https://maps.google.com/maps?q=京都郡苅田町京町2-10-5,6:00-22:00,イセキ製・メンテナンス良好,京都郡,苅田町,福岡県,093-567-8901,イセキ,コイン精米,"iseki,kanda"
みやこ町コイン精米,京都郡みやこ町勝山上田960-1,https://maps.google.com/maps?q=京都郡みやこ町勝山上田960-1,24時間,山間部でも24時間利用可,京都郡,みやこ町,福岡県,,クボタ,コイン精米,"24h,kubota,kanda"
博多区精米機,福岡市博多区博多駅前3-15-8,https://maps.google.com/maps?q=福岡市博多区博多駅前3-15-8,5:00-23:00,博多駅近く・アクセス良好,福岡市,博多区,福岡県,092-678-9012,イセキ,コイン精米,"iseki,hakata,fukuoka"
東区農協精米所,福岡市東区香椎駅前2-5-10,https://maps.google.com/maps?q=福岡市東区香椎駅前2-5-10,6:00-21:00,JA福岡市東・組合員優待あり,福岡市,東区,福岡県,092-789-0123,,JA精米所,"ja,higashi,fukuoka"
城南区24時間精米,福岡市城南区別府4-8-12,https://maps.google.com/maps?q=福岡市城南区別府4-8-12,24時間,住宅街の中・静かな環境,福岡市,城南区,福岡県,,クボタ,コイン精米,"24h,kubota,jonan,fukuoka"
小倉北区精米センター,北九州市小倉北区魚町2-3-15,https://maps.google.com/maps?q=北九州市小倉北区魚町2-3-15,7:00-21:00,小倉の中心部・買い物ついでに,北九州市,小倉北区,福岡県,093-890-1234,イセキ,コイン精米,"iseki,kokurakita,kitakyushu"
門司区コイン精米,北九州市門司区大里本町3-8-5,https://maps.google.com/maps?q=北九州市門司区大里本町3-8-5,24時間,港町の精米所・漁師さんご用達,北九州市,門司区,福岡県,,クボタ,コイン精米,"24h,kubota,moji,kitakyushu"
若松区農協精米,北九州市若松区本町3-12-8,https://maps.google.com/maps?q=北九州市若松区本町3-12-8,5:30-20:30,JA北九若松・地域密着型,北九州市,若松区,福岡県,093-901-2345,,JA精米所,"ja,wakamatsu,kitakyushu"
戸畑区精米機,北九州市戸畑区汐井町1-6,https://maps.google.com/maps?q=北九州市戸畑区汐井町1-6,6:00-22:00,クボタ精米機・清潔で使いやすい,北九州市,戸畑区,福岡県,,クボタ,コイン精米,"kubota,tobata,kitakyushu"
八幡東区24時間精米,北九州市八幡東区桃園2-4-10,https://maps.google.com/maps?q=北九州市八幡東区桃園2-4-10,24時間,工場地帯の精米所・労働者に人気,北九州市,八幡東区,福岡県,,イセキ,コイン精米,"24h,iseki,yahatahigashi,kitakyushu"
福岡市南区大橋精米,福岡市南区大橋2-1-35,https://maps.google.com/maps?q=福岡市南区大橋2-1-35,24時間,西鉄大橋駅近く・終電後も利用可,福岡市,南区,福岡県,,クボタ,コイン精米,"24h,kubota,minami,fukuoka"
中央区薬院精米所,福岡市中央区薬院1-14-20,https://maps.google.com/maps?q=福岡市中央区薬院1-14-20,6:30-21:30,都市部の便利な精米所,福岡市,中央区,福岡県,092-012-3456,イセキ,コイン精米,"iseki,chuo,fukuoka"
早良区西新精米機,福岡市早良区西新5-2-18,https://maps.google.com/maps?q=福岡市早良区西新5-2-18,5:00-22:00,大学生もよく利用・学割なし,福岡市,早良区,福岡県,,クボタ,コイン精米,"kubota,sawara,fukuoka"
西区今宿コイン精米,福岡市西区今宿東1-30-8,https://maps.google.com/maps?q=福岡市西区今宿東1-30-8,24時間,海沿いの精米所・潮風が爽やか,福岡市,西区,福岡県,,イセキ,コイン精米,"24h,iseki,nishi,fukuoka"
行橋市泉中央精米,行橋市泉中央2-8-15,https://maps.google.com/maps?q=行橋市泉中央2-8-15,6:00-21:00,住宅地の精米所・ファミリー向け,行橋市,,福岡県,,クボタ,コイン精米,"kubota,yukuhashi"
京都郡精米センター,京都郡苅田町殿川町1-12-3,https://maps.google.com/maps?q=京都郡苅田町殿川町1-12-3,7:00-20:00,工業団地内・従業員利用多,京都郡,苅田町,福岡県,093-123-4567,イセキ,コイン精米,"iseki,kanda"
福岡南区井尻精米,福岡市南区井尻4-25-10,https://maps.google.com/maps?q=福岡市南区井尻4-25-10,24時間,深夜も明るくて安全,福岡市,南区,福岡県,,クボタ,コイン精米,"24h,kubota,minami,fukuoka"
博多区千代精米所,福岡市博多区千代2-18-25,https://maps.google.com/maps?q=福岡市博多区千代2-18-25,5:30-21:30,下町情緒ある地域の精米所,福岡市,博多区,福岡県,092-234-5678,イセキ,コイン精米,"iseki,hakata,fukuoka"
東区和白コイン精米,福岡市東区和白3-8-15,https://maps.google.com/maps?q=福岡市東区和白3-8-15,6:00-22:00,海の中道近く・ドライブついでに,福岡市,東区,福岡県,,クボタ,コイン精米,"kubota,higashi,fukuoka"
城南区長尾精米機,福岡市城南区長尾2-5-20,https://maps.google.com/maps?q=福岡市城南区長尾2-5-20,24時間,大学近く・学生街の精米所,福岡市,城南区,福岡県,,イセキ,コイン精米,"24h,iseki,jonan,fukuoka"
小倉南区湯川精米,北九州市小倉南区湯川新町1-2-8,https://maps.google.com/maps?q=北九州市小倉南区湯川新町1-2-8,6:30-20:30,温泉街近く・観光客も利用,北九州市,小倉南区,福岡県,,クボタ,コイン精米,"kubota,kokura,kitakyushu"
八幡西区本城精米,北九州市八幡西区本城東5-3-12,https://maps.google.com/maps?q=北九州市八幡西区本城東5-3-12,24時間,ニュータウンの精米所・新しい設備,北九州市,八幡西区,福岡県,,イセキ,コイン精米,"24h,iseki,yahata,kitakyushu"
行橋市今井精米所,行橋市今井3-15-25,https://maps.google.com/maps?q=行橋市今井3-15-25,5:00-21:00,農村部・本格的な玄米が手に入る,行橋市,,福岡県,0930-34-5678,クボタ,コイン精米,"kubota,yukuhashi"`;

            try {
                Papa.parse(csvData, {
                    header: true,
                    skipEmptyLines: true,
                    complete: function(results) {
                        seimaishosData = results.data.map(row => ({
                            name: row.name || '',
                            address: row.address || '',
                            mapLink: row.mapLink || '#',
                            hours: row.hours || '',
                            notes: row.notes || '',
                            city: row.city || '',
                            ward: row.ward || '',
                            prefecture: row.prefecture || '福岡県',
                            phone: row.phone || '',
                            brand: row.brand || '',
                            type: row.type || '',
                            tags: row.tags ? row.tags.split(',').map(tag => tag.trim().replace(/"/g, '')) : []
                        }));
                        
                        filteredData = [...seimaishosData];
                        document.getElementById('loading').style.display = 'none';
                        document.getElementById('results').style.display = 'grid';
                        updateStats();
                        renderResults();
                    },
                    error: function(error) {
                        console.error('CSV parsing error:', error);
                        document.getElementById('loading').innerHTML = 'データの解析に失敗しました。';
                    }
                });
            } catch (error) {
                console.error('データの読み込みに失敗しました:', error);
                document.getElementById('loading').innerHTML = 'データの読み込みに失敗しました。しばらく時間をおいて再度お試しください。';
            }
        }

        function createSeimaishooCard(seimaisho, index) {
            const safeMapLink = seimaisho.mapLink && seimaisho.mapLink !== '#' ? seimaisho.mapLink : `https://www.google.com/maps/search/${encodeURIComponent(seimaisho.address)}`;
            
            return `
                <article class="seimaisho-card" itemscope itemtype="http://schema.org/LocalBusiness" data-index="${index}">
                    <h3 class="seimaisho-name" itemprop="name">${seimaisho.name}</h3>
                    <div class="seimaisho-address" itemprop="address" itemscope itemtype="http://schema.org/PostalAddress">
                        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                        </svg>
                        <span itemprop="streetAddress">${seimaisho.address}</span>
                    </div>
                    ${seimaisho.hours ? `
                        <div class="seimaisho-hours" itemprop="openingHours">
                            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                            </svg>
                            営業時間: ${seimaisho.hours}
                        </div>
                    ` : ''}
                    ${seimaisho.notes ? `
                        <div class="seimaisho-notes" itemprop="description">
                            ${seimaisho.notes}
                        </div>
                    ` : ''}
                    ${seimaisho.brand ? `
                        <div style="color: #28a745; font-size: 0.9rem; margin-bottom: 10px;">
                            精米機メーカー: ${seimaisho.brand}
                        </div>
                    ` : ''}
                    <a href="${safeMapLink}" target="_blank" rel="noopener" class="map-link" itemprop="hasMap">
                        地図で見る
                    </a>
                </article>
            `;
        }

        function renderResults() {
            const resultsContainer = document.getElementById('results');
            const noResultsDiv = document.getElementById('noResults');

            if (filteredData.length === 0) {
                resultsContainer.style.display = 'none';
                noResultsDiv.style.display = 'block';
            } else {
                resultsContainer.style.display = 'grid';
                noResultsDiv.style.display = 'none';
                resultsContainer.innerHTML = filteredData.map((seimaisho, index) => createSeimaishooCard(seimaisho, index)).join('');
            }
        }

        function updateStats() {
            document.getElementById('total-count').textContent = seimaishosData.length;
            document.getElementById('displayed-count').textContent = filteredData.length;
        }

        function filterData() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            const activeFilter = document.querySelector('.filter-btn.active').dataset.filter;

            filteredData = seimaishosData.filter(seimaisho => {
                // 検索語でのフィルタリング
                const searchFields = [
                    seimaisho.name,
                    seimaisho.address,
                    seimaisho.notes,
                    seimaisho.city,
                    seimaisho.ward,
                    seimaisho.brand,
                    seimaisho.type
                ].join(' ').toLowerCase();
                
                const matchesSearch = !searchTerm || searchFields.includes(searchTerm);

                // フィルターでの絞り込み
                let matchesFilter = true;
                if (activeFilter !== 'all') {
                    matchesFilter = seimaisho.tags.includes(activeFilter) ||
                                  seimaisho.city.toLowerCase().includes(activeFilter) ||
                                  seimaisho.ward.toLowerCase().includes(activeFilter) ||
                                  seimaisho.brand.toLowerCase().includes(activeFilter) ||
                                  seimaisho.type.toLowerCase().includes(activeFilter);
                }

                return matchesSearch && matchesFilter;
            });

            updateStats();
            renderResults();
        }

        // テーマ切り替え機能
        const themeToggle = document.getElementById('themeToggle');
        const body = document.body;

        themeToggle.addEventListener('click', () => {
            body.classList.toggle('dark');
            updateThemeButton();
        });

        function updateThemeButton() {
            if (body.classList.contains('dark')) {
                themeToggle.textContent = '☀️';
                themeToggle.setAttribute('aria-label', 'ライトモードに切り替え');
            } else {
                themeToggle.textContent = '🌙';
                themeToggle.setAttribute('aria-label', 'ダークモードに切り替え');
            }
        }

        // イベントリスナーの設定
        document.addEventListener('DOMContentLoaded', function() {
            // データ読み込み
            loadCSVData();

            // 検索入力のデバウンス処理
            let searchTimeout;
            document.getElementById('searchInput').addEventListener('input', (e) => {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    filterData();
                    
                    // Google Analytics - 検索イベント
                    if (typeof gtag !== 'undefined' && e.target.value.trim()) {
                        gtag('event', 'search', {
                            event_category: 'Site Search',
                            event_label: 'Seimaisho Search',
                            search_term: e.target.value.trim(),
                            page_location: window.location.href
                        });
                    }
                }, 300);
            });

            // フィルターボタンのイベントリスナー
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelector('.filter-btn.active').classList.remove('active');
                    btn.classList.add('active');
                    
                    // Google Analytics - フィルタークリック
                    if (typeof gtag !== 'undefined') {
                        gtag('event', 'filter_click', {
                            event_category: 'Site Interaction',
                            event_label: 'Filter Applied',
                            filter_type: btn.dataset.filter,
                            page_location: window.location.href
                        });
                    }
                    
                    filterData();
                });
            });
            
            // 地図リンククリックの追跡
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('map-link')) {
                    const cardElement = e.target.closest('.seimaisho-card');
                    const seimaishooName = cardElement ? cardElement.querySelector('.seimaisho-name').textContent : 'Unknown';
                    
                    if (typeof gtag !== 'undefined') {
                        gtag('event', 'map_click', {
                            event_category: 'External Link',
                            event_label: 'Map Link Click',
                            seimaisho_name: seimaishooName,
                            page_location: window.location.href
                        });
                    }
                }
            });
            
            // テーマ切り替えの追跡
            themeToggle.addEventListener('click', () => {
                body.classList.toggle('dark');
                const currentTheme = body.classList.contains('dark') ? 'dark' : 'light';
                updateThemeButton();
                
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'theme_toggle', {
                        event_category: 'Site Interaction',
                        event_label: 'Theme Changed',
                        theme: currentTheme,
                        page_location: window.location.href
                    });
                }
            });
        });
    </script>
</body>
</html>
